<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oscs - NonTest</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .word {
            transition: all 0.2s ease;
        }
        .active {
            background-color: rgba(59, 130, 246, 0.2);
            border-radius: 2px;
        }
        .correct {
            color: #10b981;
        }
        .incorrect {
            color: #ef4444;
            text-decoration: underline;
        }
        .cursor {
            display: inline-block;
            width: 2px;
            height: 24px;
            background-color: #3b82f6;
            animation: blink 1s infinite;
            position: absolute;
            transform: translateY(2px);
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .type-area {
            min-height: 150px;
        }
        .difficulty-btn.active {
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex flex-col">
    <header class="bg-gray-800 py-4 px-6 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold text-blue-400">oscs</h1>
            <div class="flex space-x-4">
                <button id="restart-btn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-md transition">
                    <i class="fas fa-redo mr-2"></i>Restart
                </button>
                <button id="settings-btn" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-md transition">
                    <i class="fas fa-cog mr-2"></i>Settings
                </button>
            </div>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 flex flex-col items-center">
        <div class="w-full max-w-4xl">
            <!-- Difficulty Selector -->
            <div class="flex justify-center mb-8 gap-2 flex-wrap">
                <button class="difficulty-btn px-4 py-2 rounded-md border border-green-500 text-green-400 hover:bg-green-900/30 transition" data-difficulty="easy">
                    Super Easy
                </button>
                <button class="difficulty-btn px-4 py-2 rounded-md border border-blue-500 text-blue-400 hover:bg-blue-900/30 transition active" data-difficulty="medium">
                    Medium
                </button>
                <button class="difficulty-btn px-4 py-2 rounded-md border border-yellow-500 text-yellow-400 hover:bg-yellow-900/30 transition" data-difficulty="hard">
                    Hard
                </button>
                <button class="difficulty-btn px-4 py-2 rounded-md border border-red-500 text-red-400 hover:bg-red-900/30 transition" data-difficulty="expert">
                    Expert
                </button>
            </div>

            <!-- Timer and Stats -->
            <div class="flex justify-between mb-4 text-gray-400">
                <div class="text-xl font-mono" id="timer">60</div>
                <div class="flex gap-6">
                    <div>
                        <span class="text-gray-400">WPM:</span>
                        <span id="wpm" class="ml-2 font-bold text-blue-400">0</span>
                    </div>
                    <div>
                        <span class="text-gray-400">Accuracy:</span>
                        <span id="accuracy" class="ml-2 font-bold text-green-400">0%</span>
                    </div>
                    <div>
                        <span class="text-gray-400">Raw:</span>
                        <span id="raw-wpm" class="ml-2 font-bold text-yellow-400">0</span>
                    </div>
                </div>
            </div>

            <!-- Typing Area -->
            <div class="type-area bg-gray-800 rounded-lg p-6 mb-8 text-xl leading-relaxed relative" id="typing-area">
                <div id="words-container" class="flex flex-wrap"></div>
                <div id="cursor" class="cursor"></div>
            </div>

            <!-- Input (hidden, used for capturing keystrokes) -->
            <input type="text" id="input-field" class="opacity-0 absolute -left-full" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">

            <!-- Results Modal -->
            <div id="results-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
                <div class="bg-gray-800 rounded-lg p-8 max-w-md w-full">
                    <h2 class="text-2xl font-bold mb-6 text-center">Test Completed!</h2>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-700 p-4 rounded-lg text-center">
                            <div class="text-gray-400">WPM</div>
                            <div id="result-wpm" class="text-3xl font-bold text-blue-400">0</div>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg text-center">
                            <div class="text-gray-400">Accuracy</div>
                            <div id="result-accuracy" class="text-3xl font-bold text-green-400">0%</div>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg text-center">
                            <div class="text-gray-400">Raw WPM</div>
                            <div id="result-raw" class="text-3xl font-bold text-yellow-400">0</div>
                        </div>
                        <div class="bg-gray-700 p-4 rounded-lg text-center">
                            <div class="text-gray-400">Characters</div>
                            <div id="result-chars" class="text-3xl font-bold text-purple-400">0</div>
                        </div>
                    </div>
                    
                    <div class="flex justify-center">
                        <button id="close-modal" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-md transition w-full">
                            <i class="fas fa-redo mr-2"></i>Try Again
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 py-4 text-center text-gray-400">
        <div class="container mx-auto">
            <p>Created with ❤️ using HTML, CSS, and JavaScript</p>
        </div>
    </footer>

    <script>
        // Word banks for different difficulty levels
        const wordBanks = {
            easy: [
                'the', 'and', 'for', 'are', 'but', 'not', 'you', 'all', 'any', 'can', 'her', 'was', 'one', 'our', 'out', 'day', 'get', 'has', 'him', 'his', 'how', 'man', 'new', 'now', 'old', 'see', 'two', 'way', 'who', 'boy', 'did', 'its', 'let', 'put', 'say', 'she', 'too', 'use', 'mom', 'dad', 'cat', 'dog', 'sun', 'fun', 'run', 'big', 'red', 'hot', 'hat', 'sit'
            ],
            medium: [
                'about', 'above', 'after', 'again', 'below', 'could', 'every', 'first', 'found', 'great', 'house', 'large', 'learn', 'never', 'other', 'place', 'plant', 'point', 'right', 'small', 'sound', 'spell', 'still', 'study', 'their', 'there', 'these', 'thing', 'think', 'three', 'water', 'where', 'which', 'world', 'would', 'write', 'years', 'under', 'story', 'night', 'light', 'might', 'start', 'earth', 'paper', 'music', 'human', 'color', 'happy', 'heart'
            ],
            hard: [
                'ability', 'absence', 'academy', 'account', 'accused', 'achieve', 'acquire', 'address', 'advance', 'adverse', 'advised', 'adviser', 'against', 'airline', 'alcohol', 'alleged', 'already', 'analyst', 'ancient', 'another', 'anxiety', 'anxious', 'anybody', 'applied', 'arrange', 'arrival', 'article', 'assault', 'assumed', 'assured', 'attempt', 'attract', 'auction', 'average', 'backing', 'balance', 'banking', 'barrier', 'battery', 'bearing', 'beating', 'because', 'bedroom', 'believe', 'beneath', 'benefit', 'besides', 'between', 'billion', 'binding'
            ],
            expert: [
                'aberration', 'abhorrence', 'abominable', 'abundance', 'accelerate', 'accommodate', 'acquiesce', 'acrimonious', 'adjudicate', 'affirmation', 'aggravation', 'allegorical', 'ambivalence', 'ameliorate', 'anachronism', 'antagonistic', 'apocalyptic', 'apprehension', 'arbitrarily', 'archipelago', 'articulation', 'assassinate', 'astonishing', 'asymmetrical', 'atmospheric', 'authenticate', 'authoritarian', 'belligerent', 'benevolence', 'bewildering', 'bureaucracy', 'capricious', 'catastrophic', 'circumspect', 'clairvoyant', 'commemorate', 'commensurate', 'compendium', 'complacency', 'conflagration', 'conglomerate', 'connoisseur', 'consecutive', 'conspicuous', 'consternation', 'contemporary', 'contradictory', 'controversial', 'convalescent', 'corroborate', 'counterfeit'
            ]
        };

        // DOM elements
        const wordsContainer = document.getElementById('words-container');
        const inputField = document.getElementById('input-field');
        const cursor = document.getElementById('cursor');
        const timerElement = document.getElementById('timer');
        const wpmElement = document.getElementById('wpm');
        const accuracyElement = document.getElementById('accuracy');
        const rawWpmElement = document.getElementById('raw-wpm');
        const resultsModal = document.getElementById('results-modal');
        const resultWpm = document.getElementById('result-wpm');
        const resultAccuracy = document.getElementById('result-accuracy');
        const resultRaw = document.getElementById('result-raw');
        const resultChars = document.getElementById('result-chars');
        const restartBtn = document.getElementById('restart-btn');
        const closeModal = document.getElementById('close-modal');
        const difficultyBtns = document.querySelectorAll('.difficulty-btn');

        // Game state
        let words = [];
        let currentWordIndex = 0;
        let currentCharIndex = 0;
        let correctChars = 0;
        let incorrectChars = 0;
        let totalTypedChars = 0;
        let startTime;
        let timerInterval;
        let testDuration = 60; // seconds
        let timeLeft = testDuration;
        let isTestRunning = false;
        let currentDifficulty = 'medium';

        // Initialize the game
        function initGame(difficulty = 'medium') {
            // Reset game state
            wordsContainer.innerHTML = '';
            currentWordIndex = 0;
            currentCharIndex = 0;
            correctChars = 0;
            incorrectChars = 0;
            totalTypedChars = 0;
            timeLeft = testDuration;
            isTestRunning = false;
            currentDifficulty = difficulty;
            
            // Generate random words
            words = generateRandomWords(50, difficulty);
            
            // Display words
            words.forEach((word, index) => {
                const wordSpan = document.createElement('span');
                wordSpan.textContent = word;
                wordSpan.className = 'word mx-1 my-1';
                wordSpan.id = `word-${index}`;
                wordsContainer.appendChild(wordSpan);
            });
            
            // Highlight first word
            document.getElementById(`word-${currentWordIndex}`).classList.add('active');
            
            // Reset stats
            timerElement.textContent = timeLeft;
            wpmElement.textContent = '0';
            accuracyElement.textContent = '0%';
            rawWpmElement.textContent = '0';
            
            // Focus input field
            inputField.value = '';
            inputField.focus();
            
            // Position cursor
            positionCursor();
        }

        // Generate random words from the selected difficulty bank
        function generateRandomWords(count, difficulty) {
            const bank = wordBanks[difficulty];
            const randomWords = [];
            
            for (let i = 0; i < count; i++) {
                const randomIndex = Math.floor(Math.random() * bank.length);
                randomWords.push(bank[randomIndex]);
            }
            
            return randomWords;
        }

        // Position the cursor at the current character
        function positionCursor() {
            if (currentWordIndex >= words.length) return;
            
            const currentWordElement = document.getElementById(`word-${currentWordIndex}`);
            const textBeforeCursor = words[currentWordIndex].substring(0, currentCharIndex);
            
            // Create a temporary span to measure the width of the text before cursor
            const tempSpan = document.createElement('span');
            tempSpan.textContent = textBeforeCursor;
            tempSpan.style.visibility = 'hidden';
            tempSpan.style.position = 'absolute';
            tempSpan.style.whiteSpace = 'pre';
            document.body.appendChild(tempSpan);
            
            // Get the width of the text before cursor
            const textWidth = tempSpan.getBoundingClientRect().width;
            document.body.removeChild(tempSpan);
            
            // Get the position of the current word element
            const wordRect = currentWordElement.getBoundingClientRect();
            const containerRect = wordsContainer.getBoundingClientRect();
            
            // Position the cursor
            cursor.style.left = `${wordRect.left - containerRect.left + textWidth}px`;
            cursor.style.top = `${wordRect.top - containerRect.top}px`;
        }

        // Start the test timer
        function startTimer() {
            if (isTestRunning) return;
            
            isTestRunning = true;
            startTime = Date.now();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    endTest();
                } else {
                    updateStats();
                }
            }, 1000);
        }

        // Update WPM and accuracy stats
        function updateStats() {
            if (!isTestRunning) return;
            
            const elapsedMinutes = (Date.now() - startTime) / 60000;
            const wordsTyped = correctChars / 5; // Standard WPM calculation (5 characters = 1 word)
            const rawWordsTyped = (correctChars + incorrectChars) / 5;
            
            // Calculate WPM
            const wpm = Math.round(wordsTyped / elapsedMinutes);
            const rawWpm = Math.round(rawWordsTyped / elapsedMinutes);
            
            // Calculate accuracy
            const accuracy = totalTypedChars > 0 
                ? Math.round((correctChars / totalTypedChars) * 100) 
                : 0;
            
            // Update UI
            wpmElement.textContent = wpm;
            rawWpmElement.textContent = rawWpm;
            accuracyElement.textContent = `${accuracy}%`;
        }

        // End the test and show results
        function endTest() {
            clearInterval(timerInterval);
            isTestRunning = false;
            
            // Calculate final stats
            const elapsedMinutes = testDuration / 60;
            const wordsTyped = correctChars / 5;
            const rawWordsTyped = (correctChars + incorrectChars) / 5;
            
            const wpm = Math.round(wordsTyped / elapsedMinutes);
            const rawWpm = Math.round(rawWordsTyped / elapsedMinutes);
            const accuracy = totalTypedChars > 0 
                ? Math.round((correctChars / totalTypedChars) * 100) 
                : 0;
            
            // Update results modal
            resultWpm.textContent = wpm;
            resultRaw.textContent = rawWpm;
            resultAccuracy.textContent = `${accuracy}%`;
            resultChars.textContent = correctChars + incorrectChars;
            
            // Show modal
            resultsModal.classList.remove('hidden');
        }

        // Handle input
        inputField.addEventListener('input', (e) => {
            if (!isTestRunning) startTimer();
            
            const inputValue = e.target.value;
            const currentWord = words[currentWordIndex];
            const currentWordElement = document.getElementById(`word-${currentWordIndex}`);
            
            // Check if space was pressed (move to next word)
            if (inputValue.endsWith(' ')) {
                // Check if the word was completed correctly
                const typedWord = inputValue.trim();
                if (typedWord === currentWord) {
                    correctChars += currentWord.length;
                } else {
                    incorrectChars += Math.abs(currentWord.length - typedWord.length);
                }
                
                // Reset input
                e.target.value = '';
                
                // Move to next word
                currentWordElement.classList.remove('active');
                currentWordIndex++;
                currentCharIndex = 0;
                
                // Check if test is over
                if (currentWordIndex >= words.length) {
                    endTest();
                    return;
                }
                
                // Highlight next word
                document.getElementById(`word-${currentWordIndex}`).classList.add('active');
            } else {
                // Check each character
                currentCharIndex = inputValue.length;
                
                // Update character classes
                const wordChars = currentWordElement.textContent.split('');
                currentWordElement.innerHTML = '';
                
                wordChars.forEach((char, index) => {
                    const charSpan = document.createElement('span');
                    charSpan.textContent = char;
                    
                    if (index < inputValue.length) {
                        if (char === inputValue[index]) {
                            charSpan.className = 'correct';
                            correctChars++;
                        } else {
                            charSpan.className = 'incorrect';
                            incorrectChars++;
                        }
                    }
                    
                    currentWordElement.appendChild(charSpan);
                });
                
                totalTypedChars = correctChars + incorrectChars;
            }
            
            // Position cursor
            positionCursor();
            
            // Update stats
            updateStats();
        });

        // Event listeners
        restartBtn.addEventListener('click', () => {
            initGame(currentDifficulty);
        });

        closeModal.addEventListener('click', () => {
            resultsModal.classList.add('hidden');
            initGame(currentDifficulty);
        });

        difficultyBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                difficultyBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                initGame(btn.dataset.difficulty);
            });
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
            
            // Focus input field when clicking anywhere on the typing area
            document.getElementById('typing-area').addEventListener('click', () => {
                inputField.focus();
                positionCursor();
            });
        });

        // Handle keyboard events for special keys
        inputField.addEventListener('keydown', (e) => {
            // Prevent backspace from going back in browser history
            if (e.key === 'Backspace' && inputField.value === '') {
                e.preventDefault();
                
                // Move to previous word if possible
                if (currentCharIndex === 0 && currentWordIndex > 0) {
                    currentWordIndex--;
                    currentCharIndex = words[currentWordIndex].length;
                    inputField.value = words[currentWordIndex];
                    
                    // Update active word
                    document.querySelectorAll('.word').forEach(w => w.classList.remove('active'));
                    document.getElementById(`word-${currentWordIndex}`).classList.add('active');
                    
                    // Position cursor
                    positionCursor();
                }
            }
            
            // Handle tab key to prevent focus change
            if (e.key === 'Tab') {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>